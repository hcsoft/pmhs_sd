<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
    <meta http-equiv="Pragma" content="no-cache"/>
    <meta http-equiv="expires" content="0"/>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/>
    <link type="text/css" href="/css/lib/normalize.css" rel="stylesheet"/>
    <link type="text/css" href="/css/lib/font-awesome-4.3.0/css/font-awesome.min.css" rel="stylesheet"/>
    <link type="text/css" href="oldman.css" rel="stylesheet"/>
    <style type="text/css">

    </style>
</head>
<body>


<div class="outerContainer container clearfix">
    <div class="row">
        <div class="left-col">
            <ul id="left-menu" class="pinned"></ul>
        </div>
        <div class="right-col ">
            <div class="pinned toolbar">
                <button type="button">保存</button>
                <button type="button">取消</button>
                <button type="button">退出</button>
                <button type="button">打印</button>
            </div>
            <form id="questionform" name="questionform">
                <div class="result">
                    <h3 id="idx_2" style="text-align: center">服务记录表</h3>
                    <table>
                        <tr>
                            <th>体质<br>类型
                            </th>
                            <th>气虚质</th>
                            <th>阳虚质</th>
                            <th>阴虚质</th>
                            <th>痰湿质</th>
                            <th>湿热质</th>
                            <th>血瘀质</th>
                            <th>气郁质</th>
                            <th>特禀质</th>
                            <th>平和质</th>
                        </tr>
                        <tr id="result_tr">
                            <th class="head">体质<br>
                                辨识<br>
                                结果
                            </th>

                        </tr>
                    </table>

                </div>
                <div class="content">
                    <h3 id="idx_1" style="text-align: center">健康信息采集</h3>

                </div>

            </form>
        </div>
        <div class="right-menu ">
            <ul id="right-menu" class="pinned"></ul>
        </div>
    </div>
</div>


<script language="javascript" src="/js/LodopFuncs.js"></script>
<object id="LODOP" classid="clsid:2105C259-1E0C-4534-8141-A753534CB4CA"
        width=0 height=0>
    <embed id="LODOP_EM" type="application/x-print-lodop" width=0 height=0
           pluginspage="install_lodop.exe"></embed>
</object>
<script language="javascript" src="/js/lib/jquery-2.1.3.min.js"></script>
<script language="javascript" src="/js/lib/scroll-up-bar.min.js"></script>
<script language="javascript" src="/js/lib/jquery.pin.min.js"></script>
<script language="javascript" src="/js/lib/jquery.scrollTo.min.js"></script>
<script language="javascript" src="/js/lib/q.js"></script>
<script language="javascript" src="/js/util/util.js"></script>
<script type='text/javascript' src='/dwr/engine.js'></script>
<script type='text/javascript' src='/dwr/util.js'></script>
<script type='text/javascript' src='/dwr/interface/TcmService.js'></script>
<script>
    $(function () {
        $("#left-menu").append('<li id="menu_idx_2" ><a linkurl="#idx_2"><i class="fa fa-table"></i>服务记录表</a></li>');
        $("#left-menu").append('<li id="menu_idx_1" ><a linkurl="#idx_1"><i class="fa fa-table"></i>健康信息采集</a></li>');
        for (var i = 1; i < 34; i++) {
            $("#right-menu").append('<li id="menu_' + i + '" ><a  linkurl="#question_' + i + '"><i class="fa fa-pencil-square-o"></i>问题' + i + '</a></li>');
        }
        for(var i = 1;i<10;i++){
            $("#result_tr").append('<td class="score">'+
            '得分'+
            '<input id="s'+i+'" name="s'+i+'" readonly type="text">'+
            '<label>'+
            '<input type="radio" name="r'+i+'" value="1">'+
            '1. 是'+
            '</label>'+
            '<br>'+
            '<label>'+
            '<input type="radio" name="r'+i+'" value="2">'+
            '2. 倾向是'+
            '</label>'+
            '</td>');
        }

        $(".right-menu ul>li").on("click", function () {
            $(".right-menu ul>li").removeClass("active");
            $(this).addClass("active");
            $.scrollTo($(this).children("a").attr("linkurl"), 0, {offset: -50});
            return false;
        });
        $(".left-col ul>li").on("click", function () {
            $(".left-col ul>li").removeClass("active");
            $(this).addClass("active");
            $.scrollTo($(this).children("a").attr("linkurl"), 0, {offset: -80});
            return false;
        });

        TcmService.getQuestions(function (data) {
            var str = "<table>";
            for (var i = 0; i < data.length; i++) {
                str += '<tr id="question_' + (i + 1) + '" >';
                str += "<td>" + data[i][2] + "</td>";
                var json = eval(data[i][3]);
                for (var j = 0; j < json.length; j++) {
                    str += '<td><label>' + json[j]['text'] + '<input type="radio" idx="' + (i + 1) + '" id="q' + (i + 1) + '" name="q' + (i + 1) + '" value="' + json[j]['score'] + '"></label></td>';
                }
                str += "</tr>";
            }
            str += '</table>';
            $(".content").append(str);
            $(".pinned").pin({containerSelector: ".container"});
            $(".content table td:not(:first-child) , td.score").on("click", function () {
                $(this).parent().children("td").removeClass("active");
                $(this).addClass("active");
                var radio = $(this).find("input[type=radio]");
                console.log(radio.prop("checked"));
                if (radio.prop("checked")) {
                    radio.prop("checked", false);
                    $("#menu_" + radio.attr("idx")).removeClass("selected");
                    $(this).parent().removeClass("selected");
                } else {
                    radio.prop("checked", true);
                    $("#menu_" + radio.attr("idx")).addClass("selected");
                    $(this).parent().addClass("selected");
                }
                console.log($(this).find("input[type=radio]").val());
                return false;
            });
            $("td.score > label").on("click", function () {
                $(this).addClass("active");
                var radio = $(this).find("input[type=radio]");
                if (radio.prop("checked")) {
                    radio.prop("checked", false);
                    $("#menu_" + radio.attr("idx")).removeClass("selected");
                    $(this).parent().removeClass("selected");
                } else {
                    radio.prop("checked", true);
                    $("#menu_" + radio.attr("idx")).addClass("selected");
                    $(this).parent().addClass("selected");
                }
                return true;
            });

    });

    })
    ;

</script>

</body>
</html>